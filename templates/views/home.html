<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home | TechTrend</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}" />
  <script src="https://unpkg.com/vue@3"></script>

  <style>
    body { background-color: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .hero { background: linear-gradient(to right, #1f4037, #99f2c8); color: white; padding: 120px 0; text-align: center; }
    .product-card { transition: transform .3s, box-shadow .3s; border: none; border-radius: 16px; overflow: hidden;
      box-shadow: 0 2px 12px rgba(0,0,0,.08); background-color: white; }
    .product-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,.1); }
    .product-card img { height: 230px; object-fit: contain; padding: 20px; }
    .about-preview { background: linear-gradient(to bottom, #ffffff, #e9f5ef); padding: 80px 0; border-top: 1px solid #ccc; }
  </style>
</head>

<body class="d-flex flex-column min-vh-100">
  <!-- Vue should wrap NAV + MAIN so {{ cartCount }} in navbar is reactive -->
  <div id="app" class="d-flex flex-column flex-fill">

    {% include 'Layout/navbar.html' %}

    <main class="flex-fill">
      <!-- Hero -->
      <section class="hero">
        <div class="container text-center">
          <h1>Welcome to TechTrend</h1>
          <p class="lead">Discover top tech gear, gadgets, and smart lifestyle tools!</p>
          <a href="/product" class="btn mt-4">Start Exploring</a>
        </div>
      </section>

      <!-- Featured Products from SQLite -->
      <section class="py-5">
        <div class="container">
          <h2 class="text-center fw-bold mb-5">Trending Now</h2>

          {% if products %}
          <div class="row g-4">
            {% for product in products %}
            <div class="col-12 col-md-4 col-lg-4">
              <div class="card product-card h-100 text-center">
                <img src="{{ product.image or '' }}" alt="{{ product.title }}" class="card-img-top">
                <div class="card-body">
                  <h5 class="card-title" title="{{ product.title }}">{{ product.title }}</h5>
                  <span class="badge bg-primary mb-2">{{ product.category or 'Uncategorized' }}</span>
                  <p class="card-text">$ {{ '%.2f'|format(product.price or 0) }}</p>
                  <a href="{{ url_for('product_detail.product_detail', product_id=product.id) }}" class="btn w-100">
                    View Product
                  </a>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
            <div class="text-center text-muted py-5">
              <p class="mb-3">No products yet.</p>
              <a href="{{ url_for('admin.dashboard') }}" class="btn btn-outline-secondary">Add products in Admin</a>
            </div>
          {% endif %}
        </div>
      </section>

      <!-- About -->
      <section class="about-preview">
        <div class="container text-center">
          <h2 class="mb-3">Who We Are</h2>
          <p class="lead mb-4">At TechTrend, we're passionate about technology, innovation, and delivering the best digital experiences to you.</p>
          <a href="/about" class="btn">Learn More</a>
        </div>
      </section>
    </main>
  </div>

  <script>
    const app = Vue.createApp({
      data() { return { cartCount: 0 }; },
      mounted() {
        this.updateCartCount();
        // keep badge in sync if other tabs change the cart
        window.addEventListener('storage', this.updateCartCount);
      },
      methods: {
        updateCartCount() {
          const cart = JSON.parse(localStorage.getItem('cart_list') || '[]');
          this.cartCount = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
        }
      }
    });
    app.mount('#app');
  </script>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

